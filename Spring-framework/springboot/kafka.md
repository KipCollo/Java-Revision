# Kafka

## Consumers

spring.kafka.consumer.auto-commit-interval - Frequency with which the consumer offsets are auto-committed to Kafka if 'enable.auto.commit' is set to true.
spring.kafka.consumer.auto-offset-reset - What to do when there is no initial offset in Kafka or if the current offset no longer exists on the server.
spring.kafka.consumer.bootstrap-servers - Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for consumers.
spring.kafka.consumer.client-id - ID to pass to the server when making requests. Used for server-side logging.
spring.kafka.consumer.enable-auto-commit - Whether the consumer's offset is periodically committed in the background.
spring.kafka.consumer.fetch-max-wait - Maximum amount of time the server blocks before answering the fetch request if there isn't sufficient data to immediately satisfy the requirement given by "fetch-min-size".
spring.kafka.consumer.fetch-min-size - Minimum amount of data the server should return for a fetch request.
spring.kafka.consumer.group-id - Unique string that identifies the consumer group to which this consumer belongs.
spring.kafka.consumer.heartbeat-interval - Expected time between heartbeats to the consumer coordinator.
spring.kafka.consumer.isolation-level - Isolation level for reading messages that have been written transactionally.
spring.kafka.consumer.key-deserializer- Deserializer class for keys.
spring.kafka.consumer.max-poll-records - Maximum number of records returned in a single call to poll().
spring.kafka.consumer.properties.* - Additional consumer-specific properties used to configure the client.
spring.kafka.consumer.ssl.key-password - Password of the private key in the key store file.
spring.kafka.consumer.ssl.key-store-location - Location of the key store file.
spring.kafka.consumer.ssl.key-store-password - Store password for the key store file.
spring.kafka.consumer.ssl.key-store-type - Type of the key store.
spring.kafka.consumer.ssl.protocol - SSL protocol to use.
spring.kafka.consumer.ssl.trust-store-location - Location of the trust store file.
spring.kafka.consumer.ssl.trust-store-password - Store password for the trust store file.
spring.kafka.consumer.ssl.trust-store-type - Type of the trust store.
spring.kafka.consumer.value-deserializer - Deserializer class for values.

## Producers

spring.kafka.producer.acks - Number of acknowledgments the producer requires the leader to have received before considering a request complete.
spring.kafka.producer.batch-size - Default batch size. A small batch size will make batching less common and may reduce throughput (a batch size of zero disables batching entirely).
spring.kafka.producer.bootstrap-servers - Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for producers.
spring.kafka.producer.buffer-memory - Total memory size the producer can use to buffer records waiting to be sent to the server.
spring.kafka.producer.client-id - ID to pass to the server when making requests. Used for server-side logging.
spring.kafka.producer.compression-type - Compression type for all data generated by the producer.
spring.kafka.producer.key-serializer - Serializer class for keys.
spring.kafka.producer.properties.* - Additional producer-specific properties used to configure the client.
spring.kafka.producer.retries - When greater than zero, enables retrying of failed sends.
spring.kafka.producer.ssl.key-password - Password of the private key in the key store file.
spring.kafka.producer.ssl.key-store-location - Location of the key store file.
spring.kafka.producer.ssl.key-store-password - Store password for the key store file.
spring.kafka.producer.ssl.key-store-type - Type of the key store.
spring.kafka.producer.ssl.protocol - SSL protocol to use.
spring.kafka.producer.ssl.trust-store-location - Location of the trust store file.
spring.kafka.producer.ssl.trust-store-password - Store password for the trust store file.
spring.kafka.producer.ssl.trust-store-type - Type of the trust store.
spring.kafka.producer.transaction-id-prefix - When non empty, enables transaction support for producer.
spring.kafka.producer.value-serializer - Serializer class for values.

- `Configuring Topics`:-When using Spring Boot, a KafkaAdmin bean is automatically registered so you only need the NewTopic (and/or NewTopics) @Beans.

Starting with version 2.6, you can omit partitions() and/or replicas() and the broker defaults will be applied to those properties. The broker version must be at least 2.4.0 to support this feature

```java
@Bean
public NewTopic topic4() {
    return TopicBuilder.name("defaultBoth")
            .build();
}

@Bean
public NewTopic topic5() {
    return TopicBuilder.name("defaultPart")
            .replicas(1)
            .build();
}

@Bean
public NewTopic topic6() {
    return TopicBuilder.name("defaultRepl")
            .partitions(3)
            .build();
}
```

Starting with version 2.7, you can declare multiple NewTopics in a single KafkaAdmin.NewTopics bean definition:

```java
@Bean
public KafkaAdmin.NewTopics topics456() {
    return new NewTopics(
            TopicBuilder.name("defaultBoth")
                .build(),
            TopicBuilder.name("defaultPart")
                .replicas(1)
                .build(),
            TopicBuilder.name("defaultRepl")
                .partitions(3)
                .build());
}
```

- `Sending Messages`:- Using KafkaTemplate - The KafkaTemplate wraps a producer and provides convenience methods to send data to Kafka topics.Kafka template is a class which spring provides to produce messages into the Kafka Topic.

```java
private KafkaTemplate<String,String> kafkaTemplate;

public void sendMessage(String message){
    kafkaTemplate.send("TopicName",message);
}
```

```java
private KafkaProducer kafkaProducer;

@GetMapping("/publish")
public ResponseEntity<String> publish(@RequestBody String message){
    kafkaProducer.sendMessage(message)
}
```

- `@KafkaListener Annotation`:- The @KafkaListener annotation is used to designate a bean method as a listener for a listener container. The bean is wrapped in a MessagingMessageListenerAdapter configured with various features, such as converters to convert the data, if necessary, to match the method parameters.

You can configure most attributes on the annotation with SpEL by using #{…​} or property placeholders (${…​}).
Record Listeners - The @KafkaListener annotation provides a mechanism for simple POJO listeners.

```java
public class Listener {

    @KafkaListener(id = "foo", topics = "myTopic", clientIdPrefix = "myClientId")
    public void listen(String data) {
        ...
    }
}
```

## Props

spring.kafka.admin.client-id |  | ID to pass to the server when making requests. Used for server-side logging.
 spring.kafka.admin.fail-fast | false | Whether to fail fast if the broker is not available on startup.
 spring.kafka.admin.properties.* |  | Additional admin-specific properties used to configure the client.
 spring.kafka.admin.ssl.key-password |  | Password of the private key in the key store file.
 spring.kafka.admin.ssl.key-store-location |  | Location of the key store file.
 spring.kafka.admin.ssl.key-store-password |  | Store password for the key store file.
 spring.kafka.admin.ssl.key-store-type |  | Type of the key store.
 spring.kafka.admin.ssl.protocol |  | SSL protocol to use.
 spring.kafka.admin.ssl.trust-store-location |  | Location of the trust store file.
 spring.kafka.admin.ssl.trust-store-password |  | Store password for the trust store file.
 spring.kafka.admin.ssl.trust-store-type |  | Type of the trust store.
 spring.kafka.bootstrap-servers |  | Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Applies to all components unless overridden.
 spring.kafka.client-id |  | ID to pass to the server when making requests. Used for server-side logging.
 spring.kafka.consumer.auto-commit-interval |  | Frequency with which the consumer offsets are auto-committed to Kafka if 'enable.auto.commit' is set to true.
 spring.kafka.consumer.auto-offset-reset |  | What to do when there is no initial offset in Kafka or if the current offset no longer exists on the server.
 spring.kafka.consumer.bootstrap-servers |  | Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for consumers.
 spring.kafka.consumer.client-id |  | ID to pass to the server when making requests. Used for server-side logging.
 spring.kafka.consumer.enable-auto-commit |  | Whether the consumer's offset is periodically committed in the background.
 spring.kafka.consumer.fetch-max-wait |  | Maximum amount of time the server blocks before answering the fetch request if there isn't sufficient data to immediately satisfy the requirement given by "fetch-min-size".
 spring.kafka.consumer.fetch-min-size |  | Minimum amount of data the server should return for a fetch request.
 spring.kafka.consumer.group-id |  | Unique string that identifies the consumer group to which this consumer belongs.
 spring.kafka.consumer.heartbeat-interval |  | Expected time between heartbeats to the consumer coordinator.
 spring.kafka.consumer.isolation-level |  | Isolation level for reading messages that have been written transactionally.
 spring.kafka.consumer.key-deserializer |  | Deserializer class for keys.
 spring.kafka.consumer.max-poll-records |  | Maximum number of records returned in a single call to poll().
 spring.kafka.consumer.properties.* |  | Additional consumer-specific properties used to configure the client.
 spring.kafka.consumer.ssl.key-password |  | Password of the private key in the key store file.
 spring.kafka.consumer.ssl.key-store-location |  | Location of the key store file.
 spring.kafka.consumer.ssl.key-store-password |  | Store password for the key store file.
 spring.kafka.consumer.ssl.key-store-type |  | Type of the key store.
 spring.kafka.consumer.ssl.protocol |  | SSL protocol to use.
 spring.kafka.consumer.ssl.trust-store-location |  | Location of the trust store file.
 spring.kafka.consumer.ssl.trust-store-password |  | Store password for the trust store file.
 spring.kafka.consumer.ssl.trust-store-type |  | Type of the trust store.
 spring.kafka.consumer.value-deserializer |  | Deserializer class for values.
 spring.kafka.jaas.control-flag | required | Control flag for login configuration.
 spring.kafka.jaas.enabled | false | Whether to enable JAAS configuration.
 spring.kafka.jaas.login-module | com.sun.security.auth.module.Krb5LoginModule | Login module.
 spring.kafka.jaas.options.* |  | Additional JAAS options.
 spring.kafka.listener.ack-count |  | Number of records between offset commits when ackMode is "COUNT" or "COUNT_TIME".
 spring.kafka.listener.ack-mode |  | Listener AckMode. See the  | spring-kafka documentation.
 spring.kafka.listener.ack-time |  | Time between offset commits when ackMode is "TIME" or "COUNT_TIME".
 spring.kafka.listener.client-id |  | Prefix for the listener's consumer client.id property.
 spring.kafka.listener.concurrency |  | Number of threads to run in the listener containers.
 spring.kafka.listener.idle-event-interval |  | Time between publishing idle consumer events (no data received).
 spring.kafka.listener.log-container-config |  | Whether to log the container configuration during initialization (INFO level).
 spring.kafka.listener.missing-topics-fatal | true | Whether the container should fail to start if at least one of the configured topics are not present on the broker.
 spring.kafka.listener.monitor-interval |  | Time between checks for non-responsive consumers. If a duration suffix is not specified, seconds will be used.
 spring.kafka.listener.no-poll-threshold |  | Multiplier applied to "pollTimeout" to determine if a consumer is non-responsive.
 spring.kafka.listener.poll-timeout |  | Timeout to use when polling the consumer.
 spring.kafka.listener.type | single | Listener type.
 spring.kafka.producer.acks |  | Number of acknowledgments the producer requires the leader to have received before considering a request complete.
 spring.kafka.producer.batch-size |  | Default batch size. A small batch size will make batching less common and may reduce throughput (a batch size of zero disables batching entirely).
 spring.kafka.producer.bootstrap-servers |  | Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for producers.
 spring.kafka.producer.buffer-memory |  | Total memory size the producer can use to buffer records waiting to be sent to the server.
 spring.kafka.producer.client-id |  | ID to pass to the server when making requests. Used for server-side logging.
 spring.kafka.producer.compression-type |  | Compression type for all data generated by the producer.
 spring.kafka.producer.key-serializer |  | Serializer class for keys.
 spring.kafka.producer.properties.* |  | Additional producer-specific properties used to configure the client.
 spring.kafka.producer.retries |  | When greater than zero, enables retrying of failed sends.
 spring.kafka.producer.ssl.key-password |  | Password of the private key in the key store file.
 spring.kafka.producer.ssl.key-store-location |  | Location of the key store file.
 spring.kafka.producer.ssl.key-store-password |  | Store password for the key store file.
 spring.kafka.producer.ssl.key-store-type |  | Type of the key store.
 spring.kafka.producer.ssl.protocol |  | SSL protocol to use.
 spring.kafka.producer.ssl.trust-store-location |  | Location of the trust store file.
 spring.kafka.producer.ssl.trust-store-password |  | Store password for the trust store file.
 spring.kafka.producer.ssl.trust-store-type |  | Type of the trust store.
 spring.kafka.producer.transaction-id-prefix |  | When non empty, enables transaction support for producer.
 spring.kafka.producer.value-serializer |  | Serializer class for values.
 spring.kafka.properties.* |  | Additional properties, common to producers and consumers, used to configure the client.
 spring.kafka.ssl.key-password |  | Password of the private key in the key store file.
 spring.kafka.ssl.key-store-location |  | Location of the key store file.
 spring.kafka.ssl.key-store-password |  | Store password for the key store file.
 spring.kafka.ssl.key-store-type |  | Type of the key store.
 spring.kafka.ssl.protocol |  | SSL protocol to use.
 spring.kafka.ssl.trust-store-location |  | Location of the trust store file.
 spring.kafka.ssl.trust-store-password |  | Store password for the trust store file.
 spring.kafka.ssl.trust-store-type |  | Type of the trust store.
 spring.kafka.streams.application-id |  | Kafka streams application.id property; default  | spring.application.name.
 spring.kafka.streams.auto-startup | true | Whether or not to auto-start the streams factory bean.
 spring.kafka.streams.bootstrap-servers |  | Comma-delimited list of host:port pairs to use for establishing the initial connections to the Kafka cluster. Overrides the global property, for streams. | 
 spring.kafka.streams.cache-max-size-buffering |  | Maximum memory size to be used for buffering across all threads.
 spring.kafka.streams.client-id |  | ID to pass to the server when making requests. Used for server-side logging.
 spring.kafka.streams.properties.* |  | Additional Kafka properties used to configure the streams.
 spring.kafka.streams.replication-factor |  | The replication factor for change log topics and repartition topics created by the stream processing application. | 
 spring.kafka.streams.ssl.key-password |  | Password of the private key in the key store file.
 spring.kafka.streams.ssl.key-store-location |  | Location of the key store file.
 spring.kafka.streams.ssl.key-store-password |  | Store password for the key store file.
 spring.kafka.streams.ssl.key-store-type |  | Type of the key store.
 spring.kafka.streams.ssl.protocol |  | SSL protocol to use.
 spring.kafka.streams.ssl.trust-store-location |  | Location of the trust store file.
 spring.kafka.streams.ssl.trust-store-password |  | Store password for the trust store file.
 spring.kafka.streams.ssl.trust-store-type |  | Type of the trust store.
 spring.kafka.streams.state-dir |  | Directory location for the state store.
 spring.kafka.template.default-topic |  | Default topic to which messages are sent.
